<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: #000;
        }
        
        #wallpaper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 1s ease;
            opacity: 0;
        }
    </style>
</head>
<body>
    <img id="wallpaper" src="" alt="">

    <script>
        // ========== 配置 ==========
        const CONFIG = {
            GITHUB_USERNAME: 'RuangCole',
            REPOSITORY_NAME: 'scenery',
            FOLDER: 'scenery',
            PREFIX: '壁纸电脑',
            EXTENSION: '.jpg',
            START_NUM: 1,
            MAX_NUM: 50
        };
        // ========== 配置结束 ==========

        let images = [];
        let currentIndex = -1;

        // 初始化
        async function init() {
            await discoverImages();
            if (images.length > 0) {
                showRandomImage();
                
                // 点击切换
                document.addEventListener('click', showRandomImage);
                
                // 空格键切换
                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space') showRandomImage();
                });
            }
        }

        // 发现图片
        async function discoverImages() {
            const found = [];
            
            for (let i = CONFIG.START_NUM; i <= CONFIG.MAX_NUM; i++) {
                const filename = `${CONFIG.PREFIX}${i}${CONFIG.EXTENSION}`;
                const url = `https://raw.githubusercontent.com/${CONFIG.GITHUB_USERNAME}/${CONFIG.REPOSITORY_NAME}/main/${CONFIG.FOLDER}/${filename}`;
                
                if (await testImage(url)) {
                    found.push({ url, filename });
                }
                
                // 找到一些就停止
                if (found.length >= 20) break;
            }
            
            images = found;
        }

        // 测试图片是否存在
        async function testImage(url) {
            try {
                const res = await fetch(url, { method: 'HEAD' });
                return res.ok;
            } catch {
                return false;
            }
        }

        // 显示随机图片
        function showRandomImage() {
            if (images.length === 0) return;
            
            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * images.length);
            } while (randomIndex === currentIndex && images.length > 1);
            
            currentIndex = randomIndex;
            const img = images[currentIndex];
            
            const element = document.getElementById('wallpaper');
            element.style.opacity = '0';
            
            setTimeout(() => {
                element.src = img.url;
                element.style.opacity = '1';
            }, 300);
        }

        // 开始
        window.onload = init;
    </script>
</body>
</html>
